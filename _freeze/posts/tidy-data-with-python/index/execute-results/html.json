{
  "hash": "2bbae9780de99aaccfb1eed73b397ee6",
  "result": {
    "markdown": "---\ntitle: \"Post With Code\"\nsubtitle: \"A top-down approach on how to ‘Marie Kondo’ your data sets\"\nauthor: \"Jen Godlonton\"\ndate: \"2023-01-06\"\ncategories: [Python, Data Analytics, Tutorial]\nimage: \"tidy_data_visual.png\"\n---\n\nA top-down approach on how to ‘Marie Kondo’ your data sets into Hadley Wickham's definition of tidy data by introducing pandas and using it’s functionality to introduce Python. \n\n> “Tidy datasets and tidy tools work hand in hand to make data analysis easier, allowing you to focus on the interesting domain problem, not on the uninteresting logistics of data.”\n> - Hadley Wickham, Fellow of the American Statistical Association\n\nMarie Kondo famously asks us to clean our homes/spaces, discarding things that do not bring us joy and treasuring things that do. Hadley Wickham’s papers shows us how to translate that philosophy into messy datasets, and create ones that instead of bringing panic, bring joy. Tidy data has become the standard format for science and business because it allows people to easily turn a data table into graphs, analysis and insight. \n\nThe purpose of this repository is to help users coming from Excel, to create tidy data sets using Pandas by working through examples that deal with various messy datasets used in Wickham’s paper. Through the process of reading messy data, processing into tidy data and then performing basic analysis, it will also help with general better practice for data management. \n\nThe big advantage of Tidy Data is that it makes a clear distinction between a variable, an observation and a value. In this way, all data is standardised which makes it easier to collaborate on. Whether thinking about collaborators as your current colleagues, your future self, or future peers, organising and sharing data in a consistent and predictable way means less adjustment, time, and effort for all. \n\n## The Pros and Cons of Tidy Data\n\nIf you’ve read this far and are sitting there questioning why you would want a long table instead of a wide excel table where all column headers can be seen, well, the short answer is that not all data needs to be tidy. As Marie Kondo says, “If it sparks joy, keep it with confidence”. Both tidy and messy data are useful. Choose the format that makes analysis easier. Tidy data is simply another tool to keep sharp, so that when it is needed, you can put it to good use. \n\n\n| Advantages of Tidy Data | Advantages of Messy Data|\n| --- | --- |\n| Because tidy data is a standard way of structuring a dataset, it is easy for an analyst or a computer to extract needed variables. | Efficient storage for completely crossed designs which can lead to efficient computation if desired operations can be expressed as matric operations.|\n| Many analysis operations, including all aggregation functions, involve all of the values in a variable. | Presentation|\n|  | Easier data capturing|\n\n### What is Tidy Data?\n\nAccording to Wickham, in a tidy data set, every column is a variable, every row is an observation and every cell is a single value.\n\n![](data_dimensions.png)\n\nMessy datasets, by extension, violate these 3 rules in some way. The five most common problems are:\n\n1.  Column headers are values, not variable names. \n2.  Multiple variables are stored in one column.  \n3.  Variables are stored in both rows and columns. \n4.  Multiple types of observational units are stored in the same table. \n5.  A single observational unit is stored in multiple tables.\n \n \nEssentially, we want to take a wide dataset and transform it into a long one. Consider the following table.\n \n \n| Name | Treatment A | Treatment B |\n| --- | --- | --- |\n| John Smith |  - | 2 | \n| Jane Doe | 16 | 11 |\n| Mary Johnson | 3 | 1 | \n \nThe information has been presented in a common way, however, it could be reorganised making the value, variables and observation more clear, as seen below. \n\n| Name | Treatment | Value |\n| --- | --- | --- |\n| John Smith |  A | - | \n| John Smith |  B | 2 | \n| Jane Doe | A | 16 |\n| Jane Doe | B | 11 |\n| Mary Johnson | A | 3 | \n| Mary Johnson | B | 1 |\n \n## 'Cleaning' tools\n \nThe ‘cleaning’ tools we use to deal with these violations are:\n- Melting/Unpivoting (changing columns into rows)\n- Casting/Unstack (changing rows to columns)\n- String manipulation\n- Splitting\n- Regular expressions\n \n### Melting \n\n`pandas.melt()` unpivots a DataFrame from wide format to long format. \n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n# importing pandas as pd\nimport pandas as pd\n  \n# creating a dataframe\ndf = pd.DataFrame({'Name': {0: 'Jennifer', 1: 'Susan', 2: 'Tami'},\n                   'Course': {0: 'Honours', 1: 'Doctorate', 2: 'Graduate'},\n                   'Age': {0: 35, 1: 41, 2: 32}})\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>Course</th>\n      <th>Age</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Jennifer</td>\n      <td>Honours</td>\n      <td>35</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Susan</td>\n      <td>Doctorate</td>\n      <td>41</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Tami</td>\n      <td>Graduate</td>\n      <td>32</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n# Name is id_vars and Course is value_vars\npd.melt(df, id_vars =['Name'], value_vars =['Course'])\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>variable</th>\n      <th>value</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Jennifer</td>\n      <td>Course</td>\n      <td>Honours</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Susan</td>\n      <td>Course</td>\n      <td>Doctorate</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Tami</td>\n      <td>Course</td>\n      <td>Graduate</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Unstacking\n\n`pandas.unstack()` is a function that pivots the level of the indexed columns in a stacked dataframe. A stacked dataframe is usually a result of an aggregated groupby function in pandas. `stack()` sets the columns to a new level of hierarchy whereas `unstack()` pivots the indexed column.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# import the python pandas package\nimport pandas as pd\n \n# create a sample dataframe\ndf = pd.DataFrame({\"cars\": [\"VW\", \"VW\", \"Renault\", \"Renault\"],\n                     \"sales_jan\": [20, 22, 24, 26],\n                     \"sales_feb\": [11, 13, 15, 17]},\n                    columns=[\"cars\", \"sales_jan\",\n                             'sales_feb'])\ndf\n\n# aggregate the car sales data by sum min\n# and max sales of two quarters as shown\ngrouped_df = df.groupby('cars').agg(\n    {\"sales_jan\": [sum, max],\n     \"sales_feb\": [sum, min]})\n\ngrouped_df\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead tr th {\n        text-align: left;\n    }\n\n    .dataframe thead tr:last-of-type th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr>\n      <th></th>\n      <th colspan=\"2\" halign=\"left\">sales_jan</th>\n      <th colspan=\"2\" halign=\"left\">sales_feb</th>\n    </tr>\n    <tr>\n      <th></th>\n      <th>sum</th>\n      <th>max</th>\n      <th>sum</th>\n      <th>min</th>\n    </tr>\n    <tr>\n      <th>cars</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Renault</th>\n      <td>50</td>\n      <td>26</td>\n      <td>32</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>VW</th>\n      <td>42</td>\n      <td>22</td>\n      <td>24</td>\n      <td>11</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Unstacking the grouped dataframe\ngrouped_df.unstack()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n                cars   \nsales_jan  sum  Renault    50\n                VW         42\n           max  Renault    26\n                VW         22\nsales_feb  sum  Renault    32\n                VW         24\n           min  Renault    15\n                VW         11\ndtype: int64\n```\n:::\n:::\n\n\n### String Manipulation\nString manipulation is the process of changing, parsing, splicing, pasting, or analyzing strings. Sometimes, data in the string is not suitable for manipulating the analysis or get a description of the data. \n\nThere are many applications of string manipulation, below is a quick example of how to change the data type to string.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# Importing the necessary libraries\nimport pandas as pd\nimport numpy as np\n  \n# Creating a df\ndf = pd.Series(['Amanda', 'Bob', 'Claire', 'Devon', 'Evan', np.nan, 'Fred'])\ndf\n\n# %%\n# We can change the dtype after creation of dataframe\ndf.astype('string')\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n0    Amanda\n1       Bob\n2    Claire\n3     Devon\n4      Evan\n5      <NA>\n6      Fred\ndtype: string\n```\n:::\n:::\n\n\n### Splitting\n\nSplitting is as the name suggests, it gives us power to split a data frame depending on the desired outcome.  \nThere are many applications of splitting (splitting by rows, splitting a df into smaller df's...), below is a quick example of splitting a text column into 2 columns.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# import Pandas as pd\nimport pandas as pd\n\n# create a new data frame\ndf = pd.DataFrame({'Name': ['Peter Parker', 'Bruce Wayne', 'Clark Kent'],\n\t\t\t\t'Age':[32, 34, 36]})\n\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>Age</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Peter Parker</td>\n      <td>32</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Bruce Wayne</td>\n      <td>34</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Clark Kent</td>\n      <td>36</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Adding 2 new columns by splitting up Name\n# by default splitting is done on the basis of single space.\n# Naming new columns First and Last\ndf[['First','Last']] = df.Name.str.split(expand=True)\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>Age</th>\n      <th>First</th>\n      <th>Last</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Peter Parker</td>\n      <td>32</td>\n      <td>Peter</td>\n      <td>Parker</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Bruce Wayne</td>\n      <td>34</td>\n      <td>Bruce</td>\n      <td>Wayne</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Clark Kent</td>\n      <td>36</td>\n      <td>Clark</td>\n      <td>Kent</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\ndf.Name.apply(lambda x: pd.Series(str(x).split()))\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Peter</td>\n      <td>Parker</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Bruce</td>\n      <td>Wayne</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Clark</td>\n      <td>Kent</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Regular Expressions\n\nRegular expressions (regex) are essentially text patterns that you can use to automate searching through and replacing elements within strings of text. This can make cleaning and working with text-based data sets much easier, saving you the trouble of having to search through mountains of text by hand.\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\ndf = pd.DataFrame(\n\t{\n\t\t'City':['New York (City)', 'Parague', 'New Delhi (Delhi)', 'Venice', 'new Orleans'],\n        'Event':['Music', 'Poetry', 'Theatre', 'Comedy', 'Tech_Summit'],\n        'Cost':[10000, 5000, 15000, 2000, 12000]\n\t}\n)\n  \ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>City</th>\n      <th>Event</th>\n      <th>Cost</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>New York (City)</td>\n      <td>Music</td>\n      <td>10000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Parague</td>\n      <td>Poetry</td>\n      <td>5000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>New Delhi (Delhi)</td>\n      <td>Theatre</td>\n      <td>15000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Venice</td>\n      <td>Comedy</td>\n      <td>2000</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>new Orleans</td>\n      <td>Tech_Summit</td>\n      <td>12000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Importing re package for using regular expressions\nimport re\n\n# Function to clean the names\ndef Clean_names(City_name):\n\t# Search for opening bracket in the name followed by\n\t# any characters repeated any number of times\n\tif re.search('\\(.*', City_name):\n\n\t\t# Extract the position of beginning of pattern\n\t\tpos = re.search('\\(.*', City_name).start()\n\n\t\t# return the cleaned name\n\t\treturn City_name[:pos]\n\n\telse:\n\t\t# if clean up needed return the same name\n\t\treturn City_name\n\t\t\n# Updated the city columns\ndf['City'] = df['City'].apply(Clean_names)\n\n# Print the updated dataframe\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>City</th>\n      <th>Event</th>\n      <th>Cost</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>New York</td>\n      <td>Music</td>\n      <td>10000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Parague</td>\n      <td>Poetry</td>\n      <td>5000</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>New Delhi</td>\n      <td>Theatre</td>\n      <td>15000</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Venice</td>\n      <td>Comedy</td>\n      <td>2000</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>new Orleans</td>\n      <td>Tech_Summit</td>\n      <td>12000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Where to go from here\n\n- Download the repo\n- Read through Hadley Wickham’s paper on Tidy data. While this post has summarized some of the paper, going through the examples will help you hugely when working through the exercises. \n- Go through ‘README’ carefully and use the extra resources on pandas as needed.\n- Exercises 1 through to 4b, gradually provide you with less and less scaffolding, work in each notebook to try and create tidy data sets. To check your answers, use the solutions file. \n- Have fun bringing joy to your data sets! \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}